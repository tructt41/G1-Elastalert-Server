2024-02-20 09:19:08,497 - INFO - Background alerts thread 0 pending alerts sent at 2024-02-20 09:19 UTC
2024-02-20 09:19:08,502 - INFO - Disabled rules are: []
2024-02-20 09:19:08,517 - ERROR - Could not load rule rules/5m_rules/demo.yml: Invalid Rule file: rules/5m_rules/demo.yml
{'namae': 'demo', 'query_string': '*', 'type': 'flatline', 'threshoald': 1, 'timeframe': {'minutes': 60}, 'filter': [{'query': {'query_string': {'query': '$query_string$'}}}], 'index': 'g1-hq-aws-alb-*', 'realert': {'minutes': 100}, 'alert': ['debug', 'ms_teams'], 'alert_text_type': 'alert_text_only', 'alert_subject': 'Missing log on g1-hq-aws-alb', 'alert_text': '- Link: https://192.168.68.139/kibana/app/r/s/QDywq', 'ms_teams_theme_color': '#6600ff', 'ms_teams_webhook_url': '', 'rule_file': 'rules/5m_rules/demo.yml'} is not valid under any of the given schemas

Failed validating 'oneOf' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'definitions': {'arrayOfMattermostFields': {'items': {'additionalProperties': False,
                                                           'properties': {'args': {'items': {'type': 'string'},
                                                                                   'type': ['string',
                                                                                            'array']},
                                                                          'short': {'type': 'boolean'},
                                                                          'title': {'type': 'string'},
                                                                          'value': {'type': 'string'}},
                                                           'type': 'object'},
                                                 'type': 'array'},
                     'arrayOfMsTeamsFacts': {'items': {'additionalProperties': False,
                                                       'properties': {'name': {'type': 'string'},
                                                                      'value': {'type': 'string'}},
                                                       'type': 'object'},
                                             'type': 'array'},
                     'arrayOfSlackFields': {'items': {'additionalProperties': False,
                                                      'properties': {'short': {'type': 'boolean'},
                                                                     'title': {'type': 'string'},
                                                                     'value': {'type': 'string'}},
                                                      'type': 'object'},
                                            'type': 'array'},
                     'arrayOfStrings': {'items': {'type': 'string'},
                                        'type': ['string', 'array']},
                     'arrayOfStringsOrOtherArrays': {'items': {'type': ['string',
                                                                        'array']},
                                                     'type': ['string',
                                                              'array']},
                     'filter': {},
                     'mattermostField': {'additionalProperties': False,
                                         'properties': {'args': {'items': {'type': 'string'},
                                                                 'type': ['string',
                                                                          'array']},
                                                        'short': {'type': 'boolean'},
                                                        'title': {'type': 'string'},
                                                        'value': {'type': 'string'}},
                                         'type': 'object'},
                     'msTeamsFact': {'additionalProperties': False,
                                     'properties': {'name': {'type': 'string'},
                                                    'value': {'type': 'string'}},
                                     'type': 'object'},
                     'slackField': {'additionalProperties': False,
                                    'properties': {'short': {'type': 'boolean'},
                                                   'title': {'type': 'string'},
                                                   'value': {'type': 'string'}},
                                    'type': 'object'},
                     'timeFrame': {'additionalProperties': False,
                                   'properties': {'days': {'type': 'number'},
                                                  'hours': {'type': 'number'},
                                                  'milliseconds': {'type': 'number'},
                                                  'minutes': {'type': 'number'},
                                                  'schedule': {'type': 'string'},
                                                  'seconds': {'type': 'number'},
                                                  'weeks': {'type': 'number'}},
                                   'type': 'object'},
                     'timedelta': {'additionalProperties': False,
                                   'properties': {'days': {'type': 'number'},
                                                  'hours': {'type': 'number'},
                                                  'milliseconds': {'type': 'number'},
                                                  'minutes': {'type': 'number'},
                                                  'seconds': {'type': 'number'},
                                                  'weeks': {'type': 'number'}},
                                   'type': 'object'}},
     'oneOf': [{'properties': {'type': {'enum': ['any']}}, 'title': 'Any'},
               {'properties': {'blacklist': {'items': {'type': 'string'},
                                             'type': 'array'},
                               'compare_key': {'items': {'type': 'string'},
                                               'type': ['string', 'array']},
                               'type': {'enum': ['blacklist']}},
                'required': ['blacklist', 'compare_key'],
                'title': 'Blacklist'},
               {'properties': {'compare_key': {'items': {'type': 'string'},
                                               'type': ['string', 'array']},
                               'ignore_null': {'type': 'boolean'},
                               'type': {'enum': ['whitelist']},
                               'whitelist': {'items': {'type': 'string'},
                                             'type': 'array'}},
                'required': ['whitelist', 'compare_key', 'ignore_null'],
                'title': 'Whitelist'},
               {'properties': {'compare_key': {'items': {'type': 'string'},
                                               'type': ['string', 'array']},
                               'ignore_null': {'type': 'boolean'},
                               'timeframe': {'additionalProperties': False,
                                             'properties': {'days': {'type': 'number'},
                                                            'hours': {'type': 'number'},
                                                            'milliseconds': {'type': 'number'},
                                                            'minutes': {'type': 'number'},
                                                            'schedule': {'type': 'string'},
                                                            'seconds': {'type': 'number'},
                                                            'weeks': {'type': 'number'}},
                                             'type': 'object'},
                               'type': {'enum': ['change']}},
                'required': ['query_key', 'compare_key', 'ignore_null'],
                'title': 'Change'},
               {'properties': {'attach_related': {'type': 'boolean'},
                               'num_events': {'type': 'integer'},
                               'terms_size': {'type': 'integer'},
                               'timeframe': {'additionalProperties': False,
                                             'properties': {'days': {'type': 'number'},
                                                            'hours': {'type': 'number'},
                                                            'milliseconds': {'type': 'number'},
                                                            'minutes': {'type': 'number'},
                                                            'schedule': {'type': 'string'},
                                                            'seconds': {'type': 'number'},
                                                            'weeks': {'type': 'number'}},
                                             'type': 'object'},
                               'type': {'enum': ['frequency']},
                               'use_count_query': {'type': 'boolean'},
                               'use_terms_query': {'type': 'boolean'}},
                'required': ['num_events', 'timeframe'],
                'title': 'Frequency'},
               {'properties': {'alert_on_new_data': {'type': 'boolean'},
                               'field_value': {'type': 'string'},
                               'spike_height': {'type': 'number'},
                               'spike_type': {'enum': ['up',
                                                       'down',
                                                       'both']},
                               'terms_size': {'type': 'integer'},
                               'threshold_cur': {'type': 'integer'},
                               'threshold_ref': {'type': 'integer'},
                               'timeframe': {'additionalProperties': False,
                                             'properties': {'days': {'type': 'number'},
                                                            'hours': {'type': 'number'},
                                                            'milliseconds': {'type': 'number'},
                                                            'minutes': {'type': 'number'},
                                                            'schedule': {'type': 'string'},
                                                            'seconds': {'type': 'number'},
                                                            'weeks': {'type': 'number'}},
                                             'type': 'object'},
                               'type': {'enum': ['spike']},
                               'use_count_query': {'type': 'boolean'},
                               'use_terms_query': {'type': 'boolean'}},
                'required': ['spike_height', 'spike_type', 'timeframe'],
                'title': 'Spike'},
               {'properties': {'alert_on_new_data': {'type': 'boolean'},
                               'metric_agg_type': {'enum': ['min',
                                                            'max',
                                                            'avg',
                                                            'sum',
                                                            'cardinality',
                                                            'value_count',
                                                            'percentiles']},
                               'min_doc_count': {'type': 'integer'},
                               'percentile_range': {'type': 'integer'},
                               'spike_height': {'type': 'number'},
                               'spike_type': {'enum': ['up',
                                                       'down',
                                                       'both']},
                               'terms_size': {'type': 'integer'},
                               'threshold_cur': {'type': 'number'},
                               'threshold_ref': {'type': 'number'},
                               'timeframe': {'additionalProperties': False,
                                             'properties': {'days': {'type': 'number'},
                                                            'hours': {'type': 'number'},
                                                            'milliseconds': {'type': 'number'},
                                                            'minutes': {'type': 'number'},
                                                            'schedule': {'type': 'string'},
                                                            'seconds': {'type': 'number'},
                                                            'weeks': {'type': 'number'}},
                                             'type': 'object'},
                               'type': {'enum': ['spike_aggregation']},
                               'use_count_query': {'type': 'boolean'},
                               'use_terms_query': {'type': 'boolean'}},
                'required': ['spike_height', 'spike_type', 'timeframe'],
                'title': 'Spike Aggregation'},
               {'properties': {'forget_keys': {'type': 'boolean'},
                               'terms_size': {'type': 'integer'},
                               'threshold': {'type': 'integer'},
                               'timeframe': {'additionalProperties': False,
                                             'properties': {'days': {'type': 'number'},
                                                            'hours': {'type': 'number'},
                                                            'milliseconds': {'type': 'number'},
                                                            'minutes': {'type': 'number'},
                                                            'schedule': {'type': 'string'},
                                                            'seconds': {'type': 'number'},
                                                            'weeks': {'type': 'number'}},
                                             'type': 'object'},
                               'type': {'enum': ['flatline']},
                               'use_count_query': {'type': 'boolean'},
                               'use_terms_query': {'type': 'boolean'}},
                'required': ['threshold', 'timeframe'],
                'title': 'Flatline'},
               {'properties': {'alert_on_missing_field': {'type': 'boolean'},
                               'fields': {'items': {'type': ['string',
                                                             'array']},
                                          'type': ['string', 'array']},
                               'terms_size': {'type': 'integer'},
                               'terms_window_size': {'additionalProperties': False,
                                                     'properties': {'days': {'type': 'number'},
                                                                    'hours': {'type': 'number'},
                                                                    'milliseconds': {'type': 'number'},
                                                                    'minutes': {'type': 'number'},
                                                                    'schedule': {'type': 'string'},
                                                                    'seconds': {'type': 'number'},
                                                                    'weeks': {'type': 'number'}},
                                                     'type': 'object'},
                               'type': {'enum': ['new_term']},
                               'use_keyword_postfix': {'type': 'boolean'},
                               'use_terms_query': {'type': 'boolean'},
                               'window_step_size': {'additionalProperties': False,
                                                    'properties': {'days': {'type': 'number'},
                                                                   'hours': {'type': 'number'},
                                                                   'milliseconds': {'type': 'number'},
                                                                   'minutes': {'type': 'number'},
                                                                   'schedule': {'type': 'string'},
                                                                   'seconds': {'type': 'number'},
                                                                   'weeks': {'type': 'number'}},
                                                    'type': 'object'}},
                'required': [],
                'title': 'New Term'},
               {'properties': {'cardinality_field': {'type': 'string'},
                               'max_cardinality': {'type': 'integer'},
                               'min_cardinality': {'type': 'integer'},
                               'timeframe': {'additionalProperties': False,
                                             'properties': {'days': {'type': 'number'},
                                                            'hours': {'type': 'number'},
                                                            'milliseconds': {'type': 'number'},
                                                            'minutes': {'type': 'number'},
                                                            'schedule': {'type': 'string'},
                                                            'seconds': {'type': 'number'},
                                                            'weeks': {'type': 'number'}},
                                             'type': 'object'},
                               'type': {'enum': ['cardinality']}},
                'required': ['cardinality_field', 'timeframe'],
                'title': 'Cardinality'},
               {'properties': {'allow_buffer_time_overlap': {'type': 'boolean'},
                               'bucket_interval': {'additionalProperties': False,
                                                   'properties': {'days': {'type': 'number'},
                                                                  'hours': {'type': 'number'},
                                                                  'milliseconds': {'type': 'number'},
                                                                  'minutes': {'type': 'number'},
                                                                  'schedule': {'type': 'string'},
                                                                  'seconds': {'type': 'number'},
                                                                  'weeks': {'type': 'number'}},
                                                   'type': 'object'},
                               'max_threshold': {'type': 'number'},
                               'metric_agg_type': {'enum': ['min',
                                                            'max',
                                                            'avg',
                                                            'sum',
                                                            'cardinality',
                                                            'value_count',
                                                            'percentiles']},
                               'metric_format_string': {'type': 'string'},
                               'min_doc_count': {'type': 'integer'},
                               'min_threshold': {'type': 'number'},
                               'percentile_range': {'type': 'integer'},
                               'sync_bucket_interval': {'type': 'boolean'},
                               'type': {'enum': ['metric_aggregation']},
                               'use_run_every_query_size': {'type': 'boolean'}},
                'required': ['metric_agg_key', 'metric_agg_type'],
                'title': 'Metric Aggregation'},
               {'properties': {'allow_buffer_time_overlap': {'type': 'boolean'},
                               'bucket_interval': {'additionalProperties': False,
                                                   'properties': {'days': {'type': 'number'},
                                                                  'hours': {'type': 'number'},
                                                                  'milliseconds': {'type': 'number'},
                                                                  'minutes': {'type': 'number'},
                                                                  'schedule': {'type': 'string'},
                                                                  'seconds': {'type': 'number'},
                                                                  'weeks': {'type': 'number'}},
                                                   'type': 'object'},
                               'max_percentage': {'type': 'number'},
                               'min_denominator': {'type': 'integer'},
                               'min_percentage': {'type': 'number'},
                               'percentage_format_string': {'type': 'string'},
                               'sync_bucket_interval': {'type': 'boolean'},
                               'type': {'enum': ['percentage_match']},
                               'use_run_every_query_size': {'type': 'boolean'}},
                'required': ['match_bucket_filter'],
                'title': 'Percentage Match'},
               {'properties': {'type': {'pattern': '[.]'}},
                'title': 'Custom Rule from Module'}],
     'properties': {'aggregation': {'additionalProperties': False,
                                    'properties': {'days': {'type': 'number'},
                                                   'hours': {'type': 'number'},
                                                   'milliseconds': {'type': 'number'},
                                                   'minutes': {'type': 'number'},
                                                   'schedule': {'type': 'string'},
                                                   'seconds': {'type': 'number'},
                                                   'weeks': {'type': 'number'}},
                                    'type': 'object'},
                    'aggregation_alert_time_compared_with_timestamp_field': {'type': 'boolean'},
                    'alert_missing_value': {'type': 'string'},
                    'alert_text': {'type': 'string'},
                    'alert_text_args': {'items': {'type': 'string'},
                                        'type': 'array'},
                    'alert_text_kw': {'type': 'object'},
                    'alert_text_type': {'enum': ['alert_text_only',
                                                 'alert_text_jinja',
                                                 'exclude_fields',
                                                 'aggregation_summary_only']},
                    'alerta_api_key': {'type': 'string'},
                    'alerta_api_skip_ssl': {'type': 'boolean'},
                    'alerta_api_url': {'type': 'string'},
                    'alerta_attributes_keys': {'items': {'type': 'string'},
                                               'type': 'array'},
                    'alerta_attributes_values': {'items': {'type': 'string'},
                                                 'type': 'array'},
                    'alerta_correlate': {'items': {'type': 'string'},
                                         'type': 'array'},
                    'alerta_environment': {'type': 'string'},
                    'alerta_event': {'type': 'string'},
                    'alerta_group': {'type': 'string'},
                    'alerta_origin': {'type': 'string'},
                    'alerta_resource': {'type': 'string'},
                    'alerta_service': {'items': {'type': 'string'},
                                       'type': 'array'},
                    'alerta_severity': {'type': 'string'},
                    'alerta_tags': {'items': {'type': 'string'},
                                    'type': 'array'},
                    'alerta_text': {'type': 'string'},
                    'alerta_timeout': {'type': 'integer'},
                    'alerta_type': {'type': 'string'},
                    'alerta_use_match_timestamp': {'type': 'boolean'},
                    'alerta_use_qk_as_resource': {'type': 'boolean'},
                    'alerta_value': {'type': 'string'},
                    'alertmanager_alert_subject_labelname': {'type': 'string'},
                    'alertmanager_alert_text_labelname': {'type': 'string'},
                    'alertmanager_alertname': {'type': 'string'},
                    'alertmanager_annotations': {'minProperties': 1,
                                                 'patternProperties': {'^.+$': {'oneOf': [{'type': 'string'},
                                                                                          {'additionalProperties': False,
                                                                                           'properties': {'field': {'minLength': 1,
                                                                                                                    'type': 'string'}},
                                                                                           'required': ['field'],
                                                                                           'type': 'object'}]}},
                                                 'type': 'object'},
                    'alertmanager_api_version': {'enum': ['v1', 'v2'],
                                                 'type': 'string'},
                    'alertmanager_basic_auth_login': {'type': 'string'},
                    'alertmanager_basic_auth_password': {'type': 'string'},
                    'alertmanager_ca_certs': {'type': ['boolean',
                                                       'string']},
                    'alertmanager_fields': {'minProperties': 1,
                                            'patternProperties': {'^.+$': {'oneOf': [{'type': 'string'},
                                                                                     {'additionalProperties': False,
                                                                                      'properties': {'field': {'minLength': 1,
                                                                                                               'type': 'string'}},
                                                                                      'required': ['field'],
                                                                                      'type': 'object'}]}},
                                            'type': 'object'},
                    'alertmanager_hosts': {'items': {'type': 'string'},
                                           'type': 'array'},
                    'alertmanager_ignore_ssl_errors': {'type': 'boolean'},
                    'alertmanager_labels': {'minProperties': 1,
                                            'patternProperties': {'^.+$': {'oneOf': [{'type': 'string'},
                                                                                     {'additionalProperties': False,
                                                                                      'properties': {'field': {'minLength': 1,
                                                                                                               'type': 'string'}},
                                                                                      'required': ['field'],
                                                                                      'type': 'object'}]}},
                                            'type': 'object'},
                    'alertmanager_proxy': {'type': 'string'},
                    'alertmanager_resolve_time': {'additionalProperties': False,
                                                  'properties': {'days': {'type': 'number'},
                                                                 'hours': {'type': 'number'},
                                                                 'milliseconds': {'type': 'number'},
                                                                 'minutes': {'type': 'number'},
                                                                 'seconds': {'type': 'number'},
                                                                 'weeks': {'type': 'number'}},
                                                  'type': 'object'},
                    'alertmanager_timeout': {'type': 'integer'},
                    'assets_dir': {'type': 'string'},
                    'assignment_group': {'type': 'string'},
                    'bcc': {'items': {'type': 'string'},
                            'type': ['string', 'array']},
                    'buffer_time': {'additionalProperties': False,
                                    'properties': {'days': {'type': 'number'},
                                                   'hours': {'type': 'number'},
                                                   'milliseconds': {'type': 'number'},
                                                   'minutes': {'type': 'number'},
                                                   'schedule': {'type': 'string'},
                                                   'seconds': {'type': 'number'},
                                                   'weeks': {'type': 'number'}},
                                    'type': 'object'},
                    'caller_id': {'type': 'string'},
                    'category': {'type': 'string'},
                    'cc': {'items': {'type': 'string'},
                           'type': ['string', 'array']},
                    'chatwork_apikey': {'type': 'string'},
                    'chatwork_proxy': {'type': 'string'},
                    'chatwork_proxy_login': {'type': 'string'},
                    'chatwork_proxy_pass': {'type': 'string'},
                    'chatwork_room_id': {'type': 'string'},
                    'cmdb_ci': {'type': 'string'},
                    'command': {'items': {'type': 'string'},
                                'type': ['string', 'array']},
                    'comments': {'type': 'string'},
                    'custom_pretty_ts_format': {'type': 'string'},
                    'datadog_api_key': {'type': 'string'},
                    'datadog_app_key': {'type': 'string'},
                    'dingtalk_access_token': {'type': 'string'},
                    'dingtalk_btn_orientation': {'type': 'string'},
                    'dingtalk_msgtype': {'enum': ['text',
                                                  'markdown',
                                                  'single_action_card',
                                                  'action_card'],
                                         'type': 'string'},
                    'dingtalk_proxy': {'type': 'string'},
                    'dingtalk_proxy_login': {'type': 'string'},
                    'dingtalk_proxy_pass': {'type': 'string'},
                    'dingtalk_single_title': {'type': 'string'},
                    'dingtalk_single_url': {'type': 'string'},
                    'discord_embed_color': {'type': 'integer'},
                    'discord_embed_footer': {'type': 'string'},
                    'discord_embed_icon_url': {'type': 'string'},
                    'discord_emoji_title': {'type': 'string'},
                    'discord_proxy': {'type': 'string'},
                    'discord_proxy_login': {'type': 'string'},
                    'discord_proxy_password': {'type': 'string'},
                    'discord_webhook_url': {'type': 'string'},
                    'email': {'items': {'type': 'string'},
                              'type': ['string', 'array']},
                    'email_add_domain': {'type': 'string'},
                    'email_format': {'type': 'string'},
                    'email_from_field': {'type': 'string'},
                    'email_image_keys': {'items': {'type': 'string'},
                                         'type': 'array'},
                    'email_image_values': {'items': {'type': 'string'},
                                           'type': 'array'},
                    'email_reply_to': {'type': 'string'},
                    'es_bearer': {'type': 'string'},
                    'es_host': {'type': 'string'},
                    'es_hosts': {'items': {'type': 'string'},
                                 'type': 'array'},
                    'es_password': {'type': 'string'},
                    'es_port': {'type': 'integer'},
                    'es_username': {'type': 'string'},
                    'exotel_account_sid': {'type': 'string'},
                    'exotel_auth_token': {'type': 'string'},
                    'exotel_from_number': {'type': 'string'},
                    'exotel_message_body': {'type': 'string'},
                    'exotel_to_number': {'type': 'string'},
                    'exponential_realert': {'additionalProperties': False,
                                            'properties': {'days': {'type': 'number'},
                                                           'hours': {'type': 'number'},
                                                           'milliseconds': {'type': 'number'},
                                                           'minutes': {'type': 'number'},
                                                           'schedule': {'type': 'string'},
                                                           'seconds': {'type': 'number'},
                                                           'weeks': {'type': 'number'}},
                                            'type': 'object'},
                    'fail_on_non_zero_exit': {'type': 'boolean'},
                    'field': {},
                    'fields': {'item': {'type': 'string'}, 'type': 'array'},
                    'filter': {'items': {}, 'type': 'array'},
                    'from_addr': {'type': 'string'},
                    'gelf_ca_cert': {'type': 'string'},
                    'gelf_endpoint': {'type': 'string'},
                    'gelf_host': {'type': 'string'},
                    'gelf_http_headers': {'minProperties': 1,
                                          'patternProperties': {'^.+$': {'oneOf': [{'type': 'string'},
                                                                                   {'additionalProperties': False,
                                                                                    'properties': {'field': {'minLength': 1,
                                                                                                             'type': 'string'}},
                                                                                    'required': ['field'],
                                                                                    'type': 'object'}]}},
                                          'type': 'object'},
                    'gelf_http_ignore_ssl_errors': {'type': 'boolean'},
                    'gelf_log_level': {'enum': ['0',
                                                "1'",
                                                '2',
                                                '3',
                                                '4',
                                                '5',
                                                '6',
                                                '7'],
                                       'type': 'integer'},
                    'gelf_payload': {'minProperties': 1,
                                     'patternProperties': {'^.+$': {'oneOf': [{'type': 'string'},
                                                                              {'additionalProperties': False,
                                                                               'properties': {'field': {'minLength': 1,
                                                                                                        'type': 'string'}},
                                                                               'required': ['field'],
                                                                               'type': 'object'}]}},
                                     'type': 'object'},
                    'gelf_port': {'type': 'integer'},
                    'gelf_timeout': {'type': 'integer'},
                    'gelf_type': {'enum': ['http', 'tcp'],
                                  'type': 'string'},
                    'generate_kibana_discover_url': {'type': 'boolean'},
                    'gitter_msg_level': {'enum': ['info', 'error']},
                    'gitter_proxy': {'type': 'string'},
                    'gitter_webhook_url': {'type': 'string'},
                    'googlechat_footer_kibanalink': {'type': 'string'},
                    'googlechat_format': {'enum': ['basic', 'card'],
                                          'type': 'string'},
                    'googlechat_header_image': {'type': 'string'},
                    'googlechat_header_subtitle': {'type': 'string'},
                    'googlechat_header_title': {'type': 'string'},
                    'googlechat_proxy': {'type': 'string'},
                    'googlechat_webhook_url': {'items': {'type': 'string'},
                                               'type': ['string', 'array']},
                    'http_post2_ca_certs': {'type': ['boolean', 'string']},
                    'http_post2_ignore_ssl_errors': {'type': 'boolean'},
                    'http_post2_proxy': {'type': 'string'},
                    'http_post2_timeout': {'type': 'integer'},
                    'http_post2_url': {'items': {'type': 'string'},
                                       'type': ['string', 'array']},
                    'http_post_ca_certs': {'type': ['boolean', 'string']},
                    'http_post_ignore_ssl_errors': {'type': 'boolean'},
                    'http_post_proxy': {'type': 'string'},
                    'http_post_timeout': {'type': 'integer'},
                    'http_post_url': {'items': {'type': 'string'},
                                      'type': ['string', 'array']},
                    'import': {'anyOf': [{'items': {'type': 'string'},
                                          'type': 'array'},
                                         {'type': 'string'}]},
                    'include': {'items': {'type': 'string'},
                                'type': 'array'},
                    'index': {'type': 'string'},
                    'jira_account_file': {'type': 'string'},
                    'jira_assignee': {'type': 'string'},
                    'jira_bump_after_inactivity': {'type': 'number'},
                    'jira_bump_in_statuses': {'items': {'type': 'string'},
                                              'type': ['string', 'array']},
                    'jira_bump_not_in_statuses': {'items': {'type': 'string'},
                                                  'type': ['string',
                                                           'array']},
                    'jira_bump_only': {'type': 'boolean'},
                    'jira_bump_tickets': {'type': 'boolean'},
                    'jira_component': {'items': {'type': 'string'},
                                       'type': ['string', 'array']},
                    'jira_components': {'items': {'type': 'string'},
                                        'type': ['string', 'array']},
                    'jira_description': {'type': 'string'},
                    'jira_ignore_in_title': {'type': 'string'},
                    'jira_issuetype': {'type': 'string'},
                    'jira_label': {'items': {'type': 'string'},
                                   'type': ['string', 'array']},
                    'jira_labels': {'items': {'type': 'string'},
                                    'type': ['string', 'array']},
                    'jira_max_age': {'type': 'number'},
                    'jira_priority': {'type': 'number'},
                    'jira_project': {'type': 'string'},
                    'jira_server': {'type': 'string'},
                    'jira_transition_to': {'type': 'string'},
                    'jira_watchers': {'items': {'type': 'string'},
                                      'type': ['string', 'array']},
                    'kibana_discover_app_url': {'type': 'string'},
                    'kibana_discover_columns': {'items': {'minLength': 1,
                                                          'type': 'string'},
                                                'minItems': 1,
                                                'type': 'array'},
                    'kibana_discover_from_timedelta': {'additionalProperties': False,
                                                       'properties': {'days': {'type': 'number'},
                                                                      'hours': {'type': 'number'},
                                                                      'milliseconds': {'type': 'number'},
                                                                      'minutes': {'type': 'number'},
                                                                      'seconds': {'type': 'number'},
                                                                      'weeks': {'type': 'number'}},
                                                       'type': 'object'},
                    'kibana_discover_index_pattern_id': {'minLength': 1,
                                                         'type': 'string'},
                    'kibana_discover_security_tenant': {'type:string': None},
                    'kibana_discover_to_timedelta': {'additionalProperties': False,
                                                     'properties': {'days': {'type': 'number'},
                                                                    'hours': {'type': 'number'},
                                                                    'milliseconds': {'type': 'number'},
                                                                    'minutes': {'type': 'number'},
                                                                    'seconds': {'type': 'number'},
                                                                    'weeks': {'type': 'number'}},
                                                     'type': 'object'},
                    'kibana_discover_version': {'enum': ['8.10',
                                                         '8.9',
                                                         '8.8',
                                                         '8.7',
                                                         '8.6',
                                                         '8.5',
                                                         '8.4',
                                                         '8.3',
                                                         '8.2',
                                                         '8.1',
                                                         '8.0',
                                                         '7.17',
                                                         '7.16',
                                                         '7.15',
                                                         '7.14',
                                                         '7.13',
                                                         '7.12',
                                                         '7.11',
                                                         '7.10',
                                                         '7.9',
                                                         '7.8',
                                                         '7.7',
                                                         '7.6',
                                                         '7.5',
                                                         '7.4',
                                                         '7.3',
                                                         '7.2',
                                                         '7.1',
                                                         '7.0'],
                                                'type': 'string'},
                    'kibana_password': {'type': 'string'},
                    'kibana_url': {'format': 'uri', 'type': 'string'},
                    'kibana_username': {'type': 'string'},
                    'kibana_verify_certs': {'type': 'boolean'},
                    'lark_bot_id': {'type': 'string'},
                    'lark_msgtype': {'enum': ['text'], 'type': 'string'},
                    'linenotify_access_token': {'type': 'string'},
                    'match_enhancements': {'items': {'type': 'string'},
                                           'type': 'array'},
                    'mattermost_attach_kibana_discover_url': {'type': 'boolean'},
                    'mattermost_author_icon': {'type': 'string'},
                    'mattermost_author_link': {'type': 'string'},
                    'mattermost_author_name': {'type': 'string'},
                    'mattermost_channel_override': {'items': {'type': 'string'},
                                                    'type': ['string',
                                                             'array']},
                    'mattermost_emoji_override': {'type': 'string'},
                    'mattermost_footer': {'type': 'string'},
                    'mattermost_footer_icon': {'type': 'string'},
                    'mattermost_icon_url_override': {'type': 'string'},
                    'mattermost_ignore_ssl_errors': {'type': 'boolean'},
                    'mattermost_image_url': {'type': 'string'},
                    'mattermost_kibana_discover_color': {'type': 'string'},
                    'mattermost_kibana_discover_title': {'type': 'string'},
                    'mattermost_msg_color': {'enum': ['good',
                                                      'warning',
                                                      'danger']},
                    'mattermost_msg_fields': {'items': {'additionalProperties': False,
                                                        'properties': {'args': {'items': {'type': 'string'},
                                                                                'type': ['string',
                                                                                         'array']},
                                                                       'short': {'type': 'boolean'},
                                                                       'title': {'type': 'string'},
                                                                       'value': {'type': 'string'}},
                                                        'type': 'object'},
                                              'type': 'array'},
                    'mattermost_msg_pretext': {'type': 'string'},
                    'mattermost_proxy': {'type': 'string'},
                    'mattermost_thumb_url': {'type': 'string'},
                    'mattermost_title': {'type': 'string'},
                    'mattermost_title_link': {'type': 'string'},
                    'mattermost_username_override': {'type': 'string'},
                    'mattermost_webhook_url': {'items': {'type': 'string'},
                                               'type': ['string', 'array']},
                    'max_query_size': {'type': 'integer'},
                    'max_scrolling': {'type': 'integer'},
                    'max_threads': {'type': 'integer'},
                    'misfire_grace_time': {'type': 'integer'},
                    'ms_teams_alert_facts': {'items': {'additionalProperties': False,
                                                       'properties': {'name': {'type': 'string'},
                                                                      'value': {'type': 'string'}},
                                                       'type': 'object'},
                                             'type': 'array'},
                    'ms_teams_alert_fixed_width': {'type': 'boolean'},
                    'ms_teams_alert_summary': {'type': 'string'},
                    'ms_teams_attach_kibana_discover_url': {'type': 'boolean'},
                    'ms_teams_ca_certs': {'type': ['boolean', 'string']},
                    'ms_teams_ignore_ssl_errors': {'type': 'boolean'},
                    'ms_teams_kibana_discover_title': {'type': 'string'},
                    'ms_teams_proxy': {'type': 'string'},
                    'ms_teams_theme_color': {'type': 'string'},
                    'ms_teams_webhook_url': {'items': {'type': 'string'},
                                             'type': ['string', 'array']},
                    'name': {'type': 'string'},
                    'notify_email': {'items': {'type': 'string'},
                                     'type': ['string', 'array']},
                    'opsgenie_account': {'type': 'string'},
                    'opsgenie_addr': {'type': 'string'},
                    'opsgenie_alias': {'type': 'string'},
                    'opsgenie_description': {'type:string': None},
                    'opsgenie_details': {'minProperties': 1,
                                         'patternProperties': {'^.+$': {'oneOf': [{'type': 'string'},
                                                                                  {'additionalProperties': False,
                                                                                   'properties': {'field': {'minLength': 1,
                                                                                                            'type': 'string'}},
                                                                                   'required': ['field'],
                                                                                   'type': 'object'}]}},
                                         'type': 'object'},
                    'opsgenie_entity': {'type': 'string'},
                    'opsgenie_key': {'type': 'string'},
                    'opsgenie_message': {'type': 'string'},
                    'opsgenie_priority': {'type': 'string'},
                    'opsgenie_proxy': {'type': 'string'},
                    'opsgenie_source': {'type': 'string'},
                    'opsgenie_subject': {'type': 'string'},
                    'owner': {'type': 'string'},
                    'pagerduty_api_version': {'enum': ['v1', 'v2'],
                                              'type': 'string'},
                    'pagerduty_client_name': {'type': 'string'},
                    'pagerduty_event_type': {'enum': ['none',
                                                      'trigger',
                                                      'resolve',
                                                      'acknowledge']},
                    'pagerduty_incident_key': {'type': 'string'},
                    'pagerduty_incident_key_args': {'items': {'type': 'string'},
                                                    'type': 'array'},
                    'pagerduty_proxy': {'type': 'string'},
                    'pagerduty_service_key': {'type': 'string'},
                    'pagerduty_v2_payload_class': {'type': 'string'},
                    'pagerduty_v2_payload_class_args': {'items': {'type': 'string'},
                                                        'type': 'array'},
                    'pagerduty_v2_payload_component': {'type': 'string'},
                    'pagerduty_v2_payload_component_args': {'items': {'type': 'string'},
                                                            'type': 'array'},
                    'pagerduty_v2_payload_group': {'type': 'string'},
                    'pagerduty_v2_payload_group_args': {'items': {'type': 'string'},
                                                        'type': 'array'},
                    'pagerduty_v2_payload_include_all_info': {'type': 'boolean'},
                    'pagerduty_v2_payload_severity': {'enum': ['critical',
                                                               'error',
                                                               'warning',
                                                               'info'],
                                                      'type': 'string'},
                    'pagerduty_v2_payload_source': {'type': 'string'},
                    'pagerduty_v2_payload_source_args': {'items': {'type': 'string'},
                                                         'type': 'array'},
                    'pagertree_integration_url': {'type': 'string'},
                    'pagertree_proxy': {'type': 'string'},
                    'password': {'type': 'string'},
                    'pipe_alert_text': {'type': 'boolean'},
                    'pipe_match_json': {'type': 'boolean'},
                    'priority': {'type': 'integer'},
                    'query_delay': {'additionalProperties': False,
                                    'properties': {'days': {'type': 'number'},
                                                   'hours': {'type': 'number'},
                                                   'milliseconds': {'type': 'number'},
                                                   'minutes': {'type': 'number'},
                                                   'schedule': {'type': 'string'},
                                                   'seconds': {'type': 'number'},
                                                   'weeks': {'type': 'number'}},
                                    'type': 'object'},
                    'query_key': {'items': {'type': 'string'},
                                  'type': ['string', 'array']},
                    'raw_count_keys': {'type': 'boolean'},
                    'realert': {'additionalProperties': False,
                                'properties': {'days': {'type': 'number'},
                                               'hours': {'type': 'number'},
                                               'milliseconds': {'type': 'number'},
                                               'minutes': {'type': 'number'},
                                               'schedule': {'type': 'string'},
                                               'seconds': {'type': 'number'},
                                               'weeks': {'type': 'number'}},
                                'type': 'object'},
                    'realert_key': {'type': 'string'},
                    'replace_dots_in_field_names': {'type': 'boolean'},
                    'rocket_chat_attach_kibana_discover_url': {'type': 'boolean'},
                    'rocket_chat_ca_certs': {'type': ['boolean', 'string']},
                    'rocket_chat_channel_override': {'items': {'type': 'string'},
                                                     'type': ['string',
                                                              'array']},
                    'rocket_chat_emoji_override': {'type': 'string'},
                    'rocket_chat_ignore_ssl_errors': {'type': 'boolean'},
                    'rocket_chat_kibana_discover_color': {'type': 'string'},
                    'rocket_chat_kibana_discover_title': {'type': 'string'},
                    'rocket_chat_msg_color': {'enum': ['good',
                                                       'warning',
                                                       'danger']},
                    'rocket_chat_proxy': {'type': 'string'},
                    'rocket_chat_text_string': {'type': 'string'},
                    'rocket_chat_timeout': {'type': 'integer'},
                    'rocket_chat_username_override': {'type': 'string'},
                    'rocket_chat_webhook_url': {'items': {'type': 'string'},
                                                'type': ['string',
                                                         'array']},
                    'scan_entire_timeframe': {'type': 'boolean'},
                    'servicenow_impact': {'maximum': 3,
                                          'minimum': 1,
                                          'type': 'integer'},
                    'servicenow_proxy': {'type': 'string'},
                    'servicenow_rest_url': {'type': 'string'},
                    'servicenow_urgency': {'maximum': 3,
                                           'minimum': 1,
                                           'type': 'integer'},
                    'ses_aws_access_key': {'type': 'string'},
                    'ses_aws_profile': {'type': 'string'},
                    'ses_aws_region': {'type': 'string'},
                    'ses_aws_secret_key': {'type': 'string'},
                    'ses_bcc': {'items': {'type': 'string'},
                                'type': ['string', 'array']},
                    'ses_cc': {'items': {'type': 'string'},
                               'type': ['string', 'array']},
                    'ses_email': {'items': {'type': 'string'},
                                  'type': ['string', 'array']},
                    'ses_email_reply_to': {'type': 'string'},
                    'ses_from_addr': {'type': 'string'},
                    'short_description': {'type': 'string'},
                    'shorten_kibana_discover_url': {'type': 'boolean'},
                    'slack_alert_fields': {'items': {'additionalProperties': False,
                                                     'properties': {'short': {'type': 'boolean'},
                                                                    'title': {'type': 'string'},
                                                                    'value': {'type': 'string'}},
                                                     'type': 'object'},
                                           'type': 'array'},
                    'slack_attach_jira_ticket_url': {'type': 'boolean'},
                    'slack_attach_kibana_discover_url': {'type': 'boolean'},
                    'slack_author_icon': {'type': 'string'},
                    'slack_author_link': {'type': 'string'},
                    'slack_author_name': {'type': 'string'},
                    'slack_ca_certs': {'type': ['boolean', 'string']},
                    'slack_channel_override': {'items': {'type': 'string'},
                                               'type': ['string', 'array']},
                    'slack_emoji_override': {'type': 'string'},
                    'slack_footer': {'type': 'string'},
                    'slack_footer_icon': {'type': 'string'},
                    'slack_icon_url_override': {'type': 'string'},
                    'slack_ignore_ssl_errors': {'type': 'boolean'},
                    'slack_image_url': {'type': 'string'},
                    'slack_jira_ticket_color': {'type': 'string'},
                    'slack_jira_ticket_title': {'type': 'string'},
                    'slack_kibana_discover_color': {'type': 'string'},
                    'slack_kibana_discover_title': {'type': 'string'},
                    'slack_msg_color': {'enum': ['good',
                                                 'warning',
                                                 'danger']},
                    'slack_msg_pretext': {'type': 'string'},
                    'slack_parse_override': {'enum': ['none', 'full']},
                    'slack_proxy': {'type': 'string'},
                    'slack_text_string': {'type': 'string'},
                    'slack_thumb_url': {'type': 'string'},
                    'slack_timeout': {'type': 'integer'},
                    'slack_title': {'type': 'string'},
                    'slack_title_link': {'type': 'string'},
                    'slack_username_override': {'type': 'string'},
                    'slack_webhook_url': {'items': {'type': 'string'},
                                          'type': ['string', 'array']},
                    'smtp_auth_file': {'type': 'string'},
                    'smtp_cert_file': {'type': 'string'},
                    'smtp_host': {'type': 'string'},
                    'smtp_key_file': {'type': 'string'},
                    'smtp_port': {'type': 'integer'},
                    'smtp_ssl': {'type': 'boolean'},
                    'sns_aws_access_key_id': {'type': 'string'},
                    'sns_aws_profile': {'type': 'string'},
                    'sns_aws_region': {'type': 'string'},
                    'sns_aws_secret_access_key': {'type': 'string'},
                    'sns_topic_arn': {'type': 'string'},
                    'stomp_destination': {'type': 'string'},
                    'stomp_hostname': {'type': 'string'},
                    'stomp_hostport': {'type': 'string'},
                    'stomp_login': {'type': 'string'},
                    'stomp_password': {'type': 'string'},
                    'subcategory': {'type': 'string'},
                    'summary_prefix': {'type': 'string'},
                    'summary_suffix': {'type': 'string'},
                    'summary_table_fields': {'items': {'type': 'string'},
                                             'type': 'array'},
                    'summary_table_max_rows': {'minimum': 0,
                                               'type': 'integer'},
                    'summary_table_type': {'enum': ['ascii',
                                                    'html',
                                                    'markdown'],
                                           'type': 'string'},
                    'telegram_api_url': {'type': 'string'},
                    'telegram_bot_token': {'type': 'string'},
                    'telegram_parse_mode': {'enum': ['markdown',
                                                     'markdownV2',
                                                     'html'],
                                            'type': 'string'},
                    'telegram_proxy': {'type': 'string'},
                    'telegram_proxy_login': {'type': 'string'},
                    'telegram_proxy_pass': {'type': 'string'},
                    'telegram_room_id': {'type': 'string'},
                    'tencent_sms_region': {'type': 'string'},
                    'tencent_sms_sdk_appid': {'type': 'string'},
                    'tencent_sms_secret_id': {'type': 'string'},
                    'tencent_sms_secret_key': {'type': 'string'},
                    'tencent_sms_sign_name': {'type': 'string'},
                    'tencent_sms_template_id': {'type': 'string'},
                    'tencent_sms_template_parm': {'items': {'type': 'string'},
                                                  'type': 'array'},
                    'tencent_sms_to_number': {'items': {'type': 'string'},
                                              'type': 'array'},
                    'timestamp_field': {'type': 'string'},
                    'top_count_keys': {'items': {'type': 'string'},
                                       'type': 'array'},
                    'top_count_number': {'type': 'integer'},
                    'twilio_account_sid': {'type': 'string'},
                    'twilio_auth_token': {'type': 'string'},
                    'twilio_from_number': {'type': 'string'},
                    'twilio_message_service_sid': {'type': 'string'},
                    'twilio_to_number': {'type': 'string'},
                    'twilio_use_copilot': {'type': 'boolean'},
                    'use_local_time': {'type': 'boolean'},
                    'use_ssl': {'type': 'boolean'},
                    'use_strftime_index': {'type': 'boolean'},
                    'username': {'type': 'string'},
                    'verify_certs': {'type': 'boolean'},
                    'victorops_api_key': {'type': 'string'},
                    'victorops_entity_display_name': {'type': 'string'},
                    'victorops_entity_id': {'type': 'string'},
                    'victorops_message_type': {'enum': ['INFO',
                                                        'WARNING',
                                                        'ACKNOWLEDGEMENT',
                                                        'CRITICAL',
                                                        'RECOVERY']},
                    'victorops_proxy': {'type': 'string'},
                    'victorops_routing_key': {'type': 'string'},
                    'zbx_host': {'type': 'string'},
                    'zbx_host_from_field': {'type': 'boolean'},
                    'zbx_key': {'type': 'string'},
                    'zbx_sender_host': {'type': 'string'},
                    'zbx_sender_port': {'type': 'integer'}},
     'required': ['type', 'index', 'alert'],
     'type': 'object'}

On instance:
    {'alert': ['debug', 'ms_teams'],
     'alert_subject': 'Missing log on g1-hq-aws-alb',
     'alert_text': '- Link: https://192.168.68.139/kibana/app/r/s/QDywq',
     'alert_text_type': 'alert_text_only',
     'filter': [{'query': {'query_string': {'query': '$query_string$'}}}],
     'index': 'g1-hq-aws-alb-*',
     'ms_teams_theme_color': '#6600ff',
     'ms_teams_webhook_url': '',
     'namae': 'demo',
     'query_string': '*',
     'realert': {'minutes': 100},
     'rule_file': 'rules/5m_rules/demo.yml',
     'threshoald': 1,
     'timeframe': {'minutes': 60},
     'type': 'flatline'}
2024-02-20 09:19:08,518 - INFO - Sleeping for 299.984881 seconds
2024-02-20 09:19:23,424 - DEBUG - {'_scroll_id': 'FGluY2x1ZGVfY29udGV4dF91dWlkDnF1ZXJ5VGhlbkZldGNoAA==', 'took': 0, 'timed_out': False, '_shards': {'total': 0, 'successful': 0, 'skipped': 0, 'failed': 0}, 'hits': {'total': {'value': 0, 'relation': 'eq'}, 'max_score': 0.0, 'hits': []}}
2024-02-20 09:19:23,424 - INFO - Queried rule rules/5m_rules/demo from 2024-02-20 09:14 UTC to 2024-02-20 09:19 UTC: 0 / 0 hits
2024-02-20 09:19:23,439 - DEBUG - {'_scroll_id': 'FGluY2x1ZGVfY29udGV4dF91dWlkDnF1ZXJ5VGhlbkZldGNoAA==', 'took': 0, 'timed_out': False, '_shards': {'total': 0, 'successful': 0, 'skipped': 0, 'failed': 0}, 'hits': {'total': {'value': 0, 'relation': 'eq'}, 'max_score': 0.0, 'hits': []}}
2024-02-20 09:19:23,439 - INFO - Queried rule rules/5m_rules/demo from 2024-02-20 09:19 UTC to 2024-02-20 09:19 UTC: 0 / 0 hits
2024-02-20 09:19:23,477 - INFO - Ran rules/5m_rules/demo from 2024-02-20 09:14 UTC to 2024-02-20 09:19 UTC: 0 query hits (0 already seen), 0 matches, 0 alerts sent
2024-02-20 09:19:23,477 - INFO - rules/5m_rules/demo range 301
2024-02-20 09:19:32,389 - DEBUG - {'_scroll_id': 'FGluY2x1ZGVfY29udGV4dF91dWlkDnF1ZXJ5VGhlbkZldGNoAA==', 'took': 0, 'timed_out': False, '_shards': {'total': 0, 'successful': 0, 'skipped': 0, 'failed': 0}, 'hits': {'total': {'value': 0, 'relation': 'eq'}, 'max_score': 0.0, 'hits': []}}
2024-02-20 09:19:32,389 - INFO - Queried rule demo from 2024-02-20 09:14 UTC to 2024-02-20 09:19 UTC: 0 / 0 hits
2024-02-20 09:19:32,392 - DEBUG - {'_scroll_id': 'FGluY2x1ZGVfY29udGV4dF91dWlkDnF1ZXJ5VGhlbkZldGNoAA==', 'took': 0, 'timed_out': False, '_shards': {'total': 0, 'successful': 0, 'skipped': 0, 'failed': 0}, 'hits': {'total': {'value': 0, 'relation': 'eq'}, 'max_score': 0.0, 'hits': []}}
2024-02-20 09:19:32,392 - INFO - Queried rule demo from 2024-02-20 09:19 UTC to 2024-02-20 09:19 UTC: 0 / 0 hits
2024-02-20 09:19:32,399 - INFO - Ran demo from 2024-02-20 09:14 UTC to 2024-02-20 09:19 UTC: 0 query hits (0 already seen), 0 matches, 0 alerts sent
2024-02-20 09:19:32,399 - INFO - demo range 302
